{"remainingRequest":"C:\\Users\\kprut\\Desktop\\ask-around-me\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\kprut\\Desktop\\ask-around-me\\frontend\\src\\views\\Answers.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\kprut\\Desktop\\ask-around-me\\frontend\\src\\views\\Answers.vue","mtime":1607093321483},{"path":"C:\\Users\\kprut\\Desktop\\ask-around-me\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\kprut\\Desktop\\ask-around-me\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\kprut\\Desktop\\ask-around-me\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\kprut\\Desktop\\ask-around-me\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\kprut\\Desktop\\ask-around-me\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyIKY29uc3QgZ2VvaGFzaCA9IHJlcXVpcmUoJ25nZW9oYXNoJykKY29uc3QgaWdub3JlID0gWydhbnN3ZXJzJywndG90YWxTY29yZScsJ2dlb2hhc2gnLCdxdWVzdGlvbicsJ2dlb0pzb24nLCdoYXNoS2V5JywnY3JlYXRlZCcsJ3JhbmdlS2V5JywndHlwZScsJ3N0YXRlJywnYXV0aG9yJ10KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQW5zd2VycyIsCiAgY29tcG9uZW50czogewogIH0sCiAgZGF0YTogZnVuY3Rpb24gKCkgeyAgIAogICAgcmV0dXJuIHsKICAgICAgY3VycmVudExhdDogNDAuNzM1ODIzNSwKICAgICAgcGFyZW50SGVpZ2h0OiA2MDAsCiAgICAgIGN1cnJlbnRMbmc6IC03My45OTI3MTAyLAogICAgICBsb2FkaW5nOiB0cnVlLCAgICAgICAgCiAgICAgIGhrOiBudWxsLAogICAgICByazogbnVsbCwKICAgICAgYmxvY2tzOltdCiAgICB9CiAgfSwKICBhc3luYyBtb3VudGVkICgpIHsKICAgIGNvbnNvbGUubG9nKCdtb3VudGVkJykKICAgIGNvbnNvbGUubG9nKHRoaXMuJHJvdXRlLnF1ZXJ5KQogICAgdGhpcy5oayA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmhrCiAgICB0aGlzLnJrID0gdGhpcy4kcm91dGUucXVlcnkucmsKICAgIHRoaXMucGFyZW50SGVpZ2h0ID0gdGhpcy4kcGFyZW50LiRlbC5vZmZzZXRIZWlnaHQ7ICAgICAgCiAgICBpZiAodGhpcy5oayAmJiB0aGlzLnJrKSBhd2FpdCB0aGlzLmxvYWRBbnN3ZXJzKCkKICAgIAogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgbG9hZEFuc3dlcnMoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdsb2FkQW5zd2VycyBjYWxsZWQnKQoKICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy4kQVBJdXJsfS9nZW9RdWVzdGlvbj9oaz0ke3RoaXMuaGt9JnJrPSR7dGhpcy5ya31gCiAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgdGhpcy4kYXV0aC5nZXRUb2tlblNpbGVudGx5KCk7CiAgICAgIGNvbnNvbGUubG9nKCdVUkw6ICcsIHVybCkKICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBheGlvcy5nZXQodXJsLCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAgICAgLy8gc2VuZCB0aGUgYWNjZXNzIHRva2VuIHRocm91Z2ggdGhlICdBdXRob3JpemF0aW9uJyBoZWFkZXIKICAgICAgICB9CiAgICAgIH0pCiAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZTogJywgZGF0YSkKCiAgICAgIGNvbnN0IHF1ZXN0aW9uTG9jID0gKEpTT04ucGFyc2UoZGF0YS5nZW9Kc29uLlMpKS5jb29yZGluYXRlcwogICAgICB0aGlzLmN1cnJlbnRMbmcgPSBxdWVzdGlvbkxvY1swXQogICAgICB0aGlzLmN1cnJlbnRMYXQgPSBxdWVzdGlvbkxvY1sxXQoKICAgICAgLy8gUmVtb3ZlIG5vbi1oYXNoIGF0dHJpYnMgZnJvbSByZXNwb25zZQogICAgICBpZ25vcmUubWFwKChhdHRyaWIpID0+IGRlbGV0ZSBkYXRhW2F0dHJpYl0pCgogICAgICAvLyBHZXQgdG90YWxWb3RlcwogICAgICBsZXQgdG90YWxWb3RlcyA9IDAKICAgICAgZm9yIChsZXQgaGFzaCBpbiBkYXRhKSB7CiAgICAgICAgdG90YWxWb3RlcyArPSBwYXJzZUludChkYXRhW2hhc2hdLk4pCiAgICAgIH0KCiAgICAgIC8vIFJldHVybnMgZ3JhZGllbnQgZm9yIHZhbHVlIG9mIDAtMQogICAgICBmdW5jdGlvbiBnZXRDb2xvcih2YWx1ZSl7CiAgICAgICAgbGV0IGh1ZT0oKDEtdmFsdWUpKjI0MCkKICAgICAgICByZXR1cm4gYGhzbCgke2h1ZX0sMTAwJSw1MCUpYAogICAgICB9CgogICAgICAvLyBTZXQgY29sb3IKICAgICAgZm9yIChsZXQgaGFzaCBpbiBkYXRhKSB7CiAgICAgICAgZGF0YVtoYXNoXS5wZXJjZW50ID0gZGF0YVtoYXNoXS5OIC8gdG90YWxWb3RlcwogICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGFbaGFzaF0uTiwgdG90YWxWb3RlcykKICAgICAgICBkYXRhW2hhc2hdLmNvbG9yID0gZ2V0Q29sb3IoZGF0YVtoYXNoXS5wZXJjZW50KQogICAgICB9CgogICAgICAvLyBHZXQgZ2VvaGFzaGVzCiAgICAgIGZvciAobGV0IGhhc2ggaW4gZGF0YSkgewogICAgICAgIGNvbnN0IGNvb3JkcyA9IGdlb2hhc2guZGVjb2RlX2Jib3goaGFzaCkKCiAgICAgICAgLy8gTWFwcyBib3VuZHMgbG9naWM6IGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL21hcHMvZG9jdW1lbnRhdGlvbi9qYXZhc2NyaXB0L3JlZmVyZW5jZS9jb29yZGluYXRlcyNMYXRMbmdCb3VuZHNMaXRlcmFsCiAgICAgICAgdGhpcy5ibG9ja3MucHVzaCh7CiAgICAgICAgICBub3J0aDogY29vcmRzWzBdLAogICAgICAgICAgc291dGg6IGNvb3JkcyBbMl0sCiAgICAgICAgICBlYXN0OiBjb29yZHNbM10sCiAgICAgICAgICB3ZXN0OiBjb29yZHNbMV0sCiAgICAgICAgICBjb2xvcjogZGF0YVtoYXNoXS5jb2xvciwKICAgICAgICAgIHBjdDogZGF0YVtoYXNoXS5wZXJjZW50LAogICAgICAgICAgY2VudGVyOiB7CiAgICAgICAgICAgIGxhdDogKGNvb3Jkc1swXStjb29yZHNbMl0pLzIsCiAgICAgICAgICAgIGxuZzogKGNvb3Jkc1sxXStjb29yZHNbM10pLzIKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9CiAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSkKCiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICB9CgogIH0KfQo="},{"version":3,"sources":["Answers.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8FA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA","file":"Answers.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n\r\n  <v-container class=\"pa-0 ma-0\">\r\n\r\n    <!-- Loading spinner -->\r\n    <v-container v-if=\"loading\" >\r\n      <div class=\"text-center\">\r\n        <v-progress-circular\r\n          :size=\"50\"\r\n          color=\"orange\"\r\n          indeterminate\r\n        ></v-progress-circular>        \r\n      </div>  \r\n    </v-container>\r\n\r\n    <!-- Questions list for authenticated users -->\r\n    <v-container class=\"pa-0 ma-0\" id=\"answersMap\" v-if=\"!loading\">\r\n\r\n      <GmapMap\r\n          :center=\"{lat:this.currentLat, lng:this.currentLng}\"\r\n          :zoom=\"7\"\r\n          map-type-id=\"roadmap\"\r\n          style=\"width: 100%; height: 80vh;\"\r\n          :options=\"{\r\n            zoomControl: true,\r\n            zoom: 11,\r\n            mapTypeControl: false,\r\n            scaleControl: false,\r\n            streetViewControl: false,\r\n            rotateControl: false,\r\n            fullscreenControl: false,\r\n            disableDefaultUI: false\r\n          }\"\r\n        > \r\n          <!-- <GmapRectangle \r\n            :key=\"index\"\r\n            v-for=\"(m, index) in blocks\"\r\n            :bounds=\"{north: m.north, south: m.south, east: m.east, west: m.west}\"\r\n            :options=\"{\r\n              fillColor: m.color,\r\n              fillOpacity: .6,\r\n              strokeColor: m.color,\r\n              strokeOpacity: .1,\r\n              strokeWeight: 1\r\n            }\"            \r\n          /> -->\r\n          <GmapCircle\r\n            :key=\"index\"\r\n            v-for=\"(m, index) in blocks\"\r\n            :center=\"{lat: m.center.lat, lng: m.center.lng}\"\r\n            :radius=\"(250+(1500*m.pct))\"\r\n            :options=\"{\r\n              fillColor: m.color,\r\n              fillOpacity: 0.8,\r\n              strokeColor: m.color,\r\n              strokeOpacity: 0.8,\r\n              strokeWeight: 2\r\n            }\"\r\n          />          \r\n          <GmapCircle\r\n            :center=\"{lat: currentLat, lng: currentLng}\"\r\n            :radius=\"8000\"\r\n            :options=\"{\r\n              fillColor:'blue',\r\n              fillOpacity:0.1,\r\n              strokeColor: '#0000FF',\r\n              strokeOpacity: 0.2,\r\n              strokeWeight: 5\r\n            }\"\r\n          />\r\n        </GmapMap>     \r\n\r\n    </v-container>\r\n\r\n    <!-- Back icon -->\r\n    <v-container class=\"pa-0 ma-0\">\r\n      <v-btn \r\n        v-if=\"$auth.isAuthenticated\" \r\n        fixed\r\n        dark\r\n        fab\r\n        bottom\r\n        right\r\n        color=\"gray\"\r\n        class=\"mb-4\"\r\n        to=\"/\">\r\n        <v-icon>arrow_back</v-icon>\r\n      </v-btn>\r\n    </v-container>    \r\n\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\n  import axios from \"axios\"\r\n  const geohash = require('ngeohash')\r\n  const ignore = ['answers','totalScore','geohash','question','geoJson','hashKey','created','rangeKey','type','state','author']\r\n\r\n  export default {\r\n    name: \"Answers\",\r\n    components: {\r\n    },\r\n    data: function () {   \r\n      return {\r\n        currentLat: 40.7358235,\r\n        parentHeight: 600,\r\n        currentLng: -73.9927102,\r\n        loading: true,        \r\n        hk: null,\r\n        rk: null,\r\n        blocks:[]\r\n      }\r\n    },\r\n    async mounted () {\r\n      console.log('mounted')\r\n      console.log(this.$route.query)\r\n      this.hk = this.$route.query.hk\r\n      this.rk = this.$route.query.rk\r\n      this.parentHeight = this.$parent.$el.offsetHeight;      \r\n      if (this.hk && this.rk) await this.loadAnswers()\r\n      \r\n    },\r\n    methods: {\r\n      async loadAnswers() {\r\n        console.log('loadAnswers called')\r\n\r\n        const url = `${this.$APIurl}/geoQuestion?hk=${this.hk}&rk=${this.rk}`\r\n        const token = await this.$auth.getTokenSilently();\r\n        console.log('URL: ', url)\r\n        const { data } = await axios.get(url, {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`    // send the access token through the 'Authorization' header\r\n          }\r\n        })\r\n        console.log('Response: ', data)\r\n\r\n        const questionLoc = (JSON.parse(data.geoJson.S)).coordinates\r\n        this.currentLng = questionLoc[0]\r\n        this.currentLat = questionLoc[1]\r\n\r\n        // Remove non-hash attribs from response\r\n        ignore.map((attrib) => delete data[attrib])\r\n\r\n        // Get totalVotes\r\n        let totalVotes = 0\r\n        for (let hash in data) {\r\n          totalVotes += parseInt(data[hash].N)\r\n        }\r\n\r\n        // Returns gradient for value of 0-1\r\n        function getColor(value){\r\n          let hue=((1-value)*240)\r\n          return `hsl(${hue},100%,50%)`\r\n        }\r\n\r\n        // Set color\r\n        for (let hash in data) {\r\n          data[hash].percent = data[hash].N / totalVotes\r\n          // console.log(data[hash].N, totalVotes)\r\n          data[hash].color = getColor(data[hash].percent)\r\n        }\r\n\r\n        // Get geohashes\r\n        for (let hash in data) {\r\n          const coords = geohash.decode_bbox(hash)\r\n\r\n          // Maps bounds logic: https://developers.google.com/maps/documentation/javascript/reference/coordinates#LatLngBoundsLiteral\r\n          this.blocks.push({\r\n            north: coords[0],\r\n            south: coords [2],\r\n            east: coords[3],\r\n            west: coords[1],\r\n            color: data[hash].color,\r\n            pct: data[hash].percent,\r\n            center: {\r\n              lat: (coords[0]+coords[2])/2,\r\n              lng: (coords[1]+coords[3])/2\r\n            }\r\n          })\r\n        }\r\n          // console.log(data)\r\n\r\n        this.loading = false\r\n      }\r\n\r\n    }\r\n  }\r\n</script>\r\n"]}]}